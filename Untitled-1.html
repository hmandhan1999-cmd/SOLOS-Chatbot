<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FREIGHTPRO (ERA ACKNOWLEDGMENT) - Refined</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for the filter toggle to match the Sellogs design */
        .filter-tab {
            /* Removed rounded-lg and shadow-md from default state */
            @apply px-4 py-2 text-sm font-semibold cursor-pointer transition-colors duration-200 border border-transparent;
        }
        .filter-tab.active {
            /* Only apply red background and white text when active, but border-b-2 takes precedence */
            @apply text-red-600; 
        }
        .filter-tab:not(.active) {
            @apply text-gray-700 hover:text-gray-900;
        }
        
        /* Style for the list items to match the Sellogs structure */
        .trip-card-item {
             /* Changed from shadow-sm to border-b for list item separation */
             @apply bg-white p-4 border-b border-gray-200 hover:bg-gray-50 transition duration-150;
        }
        
        /* Ensure the last item in the list container doesn't have a bottom border if the container has rounded corners */
        #trip-list-container > .trip-card-item:last-child {
            @apply border-b-0;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50 flex">

    <!-- Load Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Modal Container (Used instead of alert()) -->
    <div id="custom-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex justify-center items-center p-4">
        <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full">
            <h3 class="text-lg font-bold mb-4 text-gray-800">Action Status</h3>
            <p id="modal-message" class="text-gray-600 mb-6"></p>
            <div class="flex justify-end">
                <button id="modal-close-button" class="px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-lg hover:bg-blue-700 transition">
                    Close
                </button>
            </div>
        </div>
    </div>
    
    <!-- Desktop Sidebar -->
    <div id="desktop-sidebar" class="hidden lg:flex flex-col w-64 bg-white border-r border-gray-200 fixed h-full z-20">
        <div class="p-4 border-b border-gray-200">
            <span class="text-xl font-bold text-red-700">MOON BEVERAGES</span>
        </div>
        <nav id="sidebar-nav" class="flex flex-col space-y-2 p-4"></nav>
    </div>

    <!-- Mobile Navigation (Retained for context) -->
    <button id="mobile-menu-button" class="lg:hidden fixed top-4 left-4 z-40 p-2 bg-white rounded-lg shadow-md border"></button>
    <div id="mobile-sidebar-overlay" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 z-30 lg:hidden"></div>
    <div id="mobile-sidebar" class="fixed inset-y-0 left-0 z-40 w-64 bg-white border-r transform -translate-x-full lg:hidden transition-transform duration-300 ease-in-out">
        <div class="p-4 border-b border-gray-200">
            <span class="text-xl font-bold text-red-700">MOON BEVERAGES</span>
        </div>
        <nav id="mobile-sidebar-nav" class="flex flex-col space-y-2 p-4"></nav>
    </div>

    <!-- Main Content Area -->
    <main class="flex-1 p-4 sm:p-8 lg:ml-64 transition-all duration-300 w-full" id="main-content">
        <!-- Top Header/User Info -->
        <header class="flex justify-between items-center pb-6 border-b border-gray-200 mb-6">
            <h1 class="text-3xl font-light text-gray-800 text-balance sm:text-nowrap">
                FREIGHTPRO <span class="font-semibold">(ERA ACKNOWLEDGMENT)</span>
            </h1>
            <div class="hidden sm:flex items-center space-x-3">
                <span class="text-sm font-medium text-gray-700 text-right">bharath+MBL@sellogs.com (B)</span>
                <div class="w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center text-white font-bold">B</div>
            </div>
        </header>

        <!-- Main Content Card -->
        <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100">
            
            <!-- Filter Toggle Section (Matching Sellogs tabs) -->
            <div class="mb-4 flex space-x-4 border-b border-gray-200">
                <!-- Tabs use text color for active state, and a red bottom border -->
                <button id="filter-pending" data-filter="pending" class="filter-tab active text-red-600 -mb-[1px] border-b-2 border-red-600">
                    Pending
                </button>
                <button id="filter-completed" data-filter="completed" class="filter-tab -mb-[1px] border-b-2 border-transparent">
                    Completed
                </button>
            </div>
            
            <!-- List Header/Title -->
            <h2 id="section-title" class="text-xl font-semibold text-gray-700 mb-4 flex items-center pt-2">
                <!-- Title inserted by JS -->
            </h2>

            <div class="pt-2">
                <!-- Record Count Bar -->
                <div class="flex justify-between items-center mb-4 text-sm">
                    <span class="text-gray-600" id="record-count-span"></span>
                    <button class="flex items-center text-gray-500 hover:text-gray-700">
                        Sort By Date <span class="w-4 h-4 ml-1" data-lucide="chevron-down"></span>
                    </button>
                </div>

                <!-- List of Trips -->
                <!-- Removed inner border/shadow from container as list items now have border-b -->
                <div id="trip-list-container" class="space-y-0">
                    <!-- Trip Cards inserted by JS -->
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- Mock Data: ALL TRIPS SET TO 'Two-Way Trip' ---
        const MOCK_DATA = {
            // Trips requiring ERA Acknowledgment (Pending)
            pending: [
                { id: 1, cnNo: 'CN00000169', docType: 'INV', mode: 'FTL', route: 'DHAULANA → GHAZIABAD', date: '20-SEP-2025', status: 'Delivered (POD)', vendor: 'MBL VENDOR 1', toNo: 'T00000138', tripType: 'Two-Way Trip' },
                { id: 2, cnNo: 'CN00000170', docType: 'INV', mode: 'FTL', route: 'MANESAR → BANGALORE', date: '21-SEP-2025', status: 'Delivered (POD)', vendor: 'MBL VENDOR 2', toNo: 'T00000145', tripType: 'Two-Way Trip' },
                { id: 3, cnNo: 'CN00000171', docType: 'SRV', mode: 'LTL', route: 'NOIDA → CHENNAI', date: '22-SEP-2025', status: 'Delivered (POD)', vendor: 'MBL VENDOR 3', toNo: 'T00000146', tripType: 'Two-Way Trip' },
            ],
            // Trips where ERA Acknowledgment is already completed
            completed: [
                { id: 4, cnNo: 'CN00000165', docType: 'INV', mode: 'FTL', route: 'GURGAON → PUNE', date: '15-SEP-2025', status: 'ERA Acknowledged', vendor: 'ABC LOGISTICS', toNo: 'T00000130', tripType: 'Two-Way Trip' },
                { id: 5, cnNo: 'CN00000166', docType: 'SRV', mode: 'LTL', route: 'MUMBAI → DELHI', date: '16-SEP-2025', status: 'ERA Acknowledged', vendor: 'XYZ TRANSPORT', toNo: 'T00000131', tripType: 'Two-Way Trip' },
            ]
        };

        let currentFilter = 'pending'; 

        // --- Utility Functions ---

        function customAlert(message) {
            const modal = document.getElementById('custom-modal');
            const messageEl = document.getElementById('modal-message');
            if (messageEl) messageEl.textContent = message;
            if (modal) modal.classList.remove('hidden');
        }

        function hideModal() {
            const modal = document.getElementById('custom-modal');
            if (modal) modal.classList.add('hidden');
        }

        // --- Rendering Functions ---

        /**
         * Renders the sidebar with only FREIGHTPRO and Sign Out links.
         */
        function renderSidebar(containerEl) {
            containerEl.innerHTML = '';
            // Only keeping FREIGHTPRO and Sign Out as requested
            const links = [
                { icon: 'truck', label: 'FREIGHTPRO', active: true },
                { icon: 'log-out', label: 'Sign Out', active: false, isSignOut: true },
            ];
            
            links.forEach(link => {
                const linkHTML = `<a href="#" class="flex items-center px-4 py-3 rounded-lg text-sm transition-colors duration-150 ${link.active ? 'bg-red-50 text-red-700 font-semibold' : link.isSignOut ? 'text-gray-600 hover:bg-red-50 hover:text-red-600' : 'text-gray-600 hover:bg-gray-100 hover:text-gray-800'}">
                    <span class="w-5 h-5 mr-3" data-lucide="${link.icon}"></span>
                    ${link.label}
                </a>`;
                containerEl.insertAdjacentHTML('beforeend', linkHTML);
            });
            lucide.createIcons(); 
        }

        /**
         * Renders a single trip card with the smaller action button.
         */
        function renderTripCard(trip, isPending) {
            const isTwoWay = trip.tripType.includes('Two-Way');
            const badgeClasses = isTwoWay ? 'bg-red-600 text-white' : 'bg-gray-100 text-gray-700 border border-gray-300';
            
            const statusTextColor = isPending ? 'text-green-600' : 'text-blue-600';
            const showActionButton = isPending; 
            
            // Modified button/status size: uses px-3 py-1.5, w-full on mobile, w-fit on desktop
            const buttonContent = showActionButton ? 
                `<button data-cn-no="${trip.cnNo}" class="acknowledge-btn w-full sm:w-fit px-3 py-1.5 bg-blue-600 text-white text-xs font-semibold rounded-lg shadow-md hover:bg-blue-700 transition duration-150">
                    Acknowledge ERA
                </button>` : 
                `<div class="w-full sm:w-fit inline-flex items-center justify-center px-3 py-1.5 bg-gray-100 text-gray-500 text-xs font-semibold rounded-lg border border-gray-200 md:ml-auto">
                    <span class="w-4 h-4 mr-1" data-lucide="check-circle"></span> Acknowledged
                </div>`;

            return `
                <div class="trip-card-item grid grid-cols-1 md:grid-cols-3 gap-4">
                    
                    <!-- Column 1: Core Details -->
                    <div class="flex flex-col space-y-1">
                        <div class="text-xs uppercase text-gray-500">DOC / MODE / TYPE</div>
                        <p class="text-base font-semibold text-gray-800">
                            <span class="text-blue-600 font-bold hover:underline cursor-pointer">#${trip.cnNo}</span> 
                            <span class="text-gray-400">|</span> 
                            <span class="text-sm font-medium text-gray-600">${trip.docType} / ${trip.mode}</span>
                        </p>
                        <div class="text-sm text-gray-700 flex items-center">
                            <span class="w-4 h-4 mr-1 text-red-500" data-lucide="map-pin"></span>
                            <span class="font-medium">${trip.route}</span>
                        </div>
                    </div>

                    <!-- Column 2: Status & Date -->
                    <div class="flex flex-col space-y-1 md:text-center">
                        <div class="text-xs uppercase text-gray-500">DATE</div>
                        <p class="text-sm font-medium text-gray-700">${trip.date}</p>
                        <div class="text-xs uppercase text-gray-500 mt-2">STATUS</div>
                        <p class="text-sm font-semibold ${statusTextColor}">${trip.status}</p>
                    </div>

                    <!-- Column 3: Vendor & Actions -->
                    <div class="flex flex-col space-y-1 md:text-right">
                        <div class="text-xs uppercase text-gray-500">MBL VENDOR / TO NO.</div>
                        <p class="text-sm font-medium text-gray-700">
                            ${trip.vendor} | <span class="text-blue-500 hover:underline cursor-pointer">${trip.toNo}</span>
                        </p>
                         <div class="inline-block md:ml-auto w-fit mt-2 px-3 py-1 rounded text-xs font-semibold ${badgeClasses} whitespace-nowrap">
                            ${trip.tripType}
                        </div>
                        <div class="mt-3 md:mt-4">
                            ${buttonContent}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderTripList() {
            const container = document.getElementById('trip-list-container');
            const recordCountSpan = document.getElementById('record-count-span');
            const sectionTitle = document.getElementById('section-title');
            
            if (!container) return;

            const trips = MOCK_DATA[currentFilter] || [];
            const isPending = currentFilter === 'pending';

            // 1. Update Section Title
            const icon = isPending ? 'clock' : 'check-circle';
            const title = isPending ? 'Pending ERA Acknowledgment (Delivered Trips)' : 'Completed ERA Acknowledgment (Acknowledged Trips)';

            sectionTitle.innerHTML = `<span class="w-5 h-5 mr-2 text-orange-500" data-lucide="${icon}"></span>${title}`;


            // 2. Render Trip Cards
            container.innerHTML = trips.map(trip => renderTripCard(trip, isPending)).join('');
            
            // 3. Update Record Count
            const total = trips.length;
            const filterText = isPending ? 'Filtered for ERA Acknowledgment' : 'Showing Acknowledged Records';
            
            if (recordCountSpan) {
                recordCountSpan.innerHTML = `
                    Showing <span class="font-semibold text-blue-600">${total}</span> of <span class="font-semibold text-blue-600">${total}</span> Records
                    <span class="ml-2 text-green-600">(${filterText})</span>
                `;
            }

            // 4. Attach Event Listeners to Acknowledge Buttons (only for pending)
            if (isPending) {
                document.querySelectorAll('.acknowledge-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const cnNo = e.currentTarget.getAttribute('data-cn-no');
                        customAlert(`Acknowledging Trip #${cnNo} (ERA process initiated).`);
                    });
                });
            }
            
            // 5. Create Lucide Icons for the main content
            lucide.createIcons();
        }

        function setFilter(filterType) {
            currentFilter = filterType;

            // Update button active state and border style
            document.querySelectorAll('.filter-tab').forEach(button => {
                const isActive = button.getAttribute('data-filter') === filterType;
                
                // Toggle active text color
                button.classList.toggle('text-red-600', isActive);
                button.classList.toggle('text-gray-700', !isActive);
                
                // Set/Remove red bottom border for active tab
                button.classList.toggle('border-b-2', true); 
                button.classList.toggle('border-red-600', isActive);
                button.classList.toggle('border-transparent', !isActive);
            });

            // Re-render the list
            renderTripList();
        }


        // --- Sidebar Toggle Logic (Unchanged) ---
        function setupSidebarToggle() {
            const menuButton = document.getElementById('mobile-menu-button');
            const mobileSidebar = document.getElementById('mobile-sidebar');
            const overlay = document.getElementById('mobile-sidebar-overlay');

            menuButton.innerHTML = `<span class="w-6 h-6" data-lucide="menu"></span>`;
            
            function toggleSidebar() {
                const isOpen = mobileSidebar.classList.contains('translate-x-0');
                if (isOpen) {
                    mobileSidebar.classList.remove('translate-x-0');
                    mobileSidebar.classList.add('-translate-x-full');
                    overlay.classList.add('hidden');
                    menuButton.innerHTML = `<span class="w-6 h-6" data-lucide="menu"></span>`;
                } else {
                    mobileSidebar.classList.remove('-translate-x-full');
                    mobileSidebar.classList.add('translate-x-0');
                    overlay.classList.remove('hidden');
                    menuButton.innerHTML = `<span class="w-6 h-6" data-lucide="x"></span>`;
                }
                lucide.createIcons();
            }

            menuButton.addEventListener('click', toggleSidebar);
            overlay.addEventListener('click', toggleSidebar);
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Setup the modal close button
            const modalCloseButton = document.getElementById('modal-close-button');
            if (modalCloseButton) {
                modalCloseButton.addEventListener('click', hideModal);
            }
            
            // Setup filter buttons
            document.getElementById('filter-pending').addEventListener('click', () => setFilter('pending'));
            document.getElementById('filter-completed').addEventListener('click', () => setFilter('completed'));

            // Render navigation bars
            const desktopNav = document.getElementById('sidebar-nav');
            const mobileNav = document.getElementById('mobile-sidebar-nav');
            if (desktopNav) renderSidebar(desktopNav);
            if (mobileNav) renderSidebar(mobileNav);

            // Initial render
            setFilter('pending');

            // Setup mobile sidebar toggle behavior
            setupSidebarToggle();
        });
    </script>
</body>
</html>
